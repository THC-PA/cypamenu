<div fxLayout="row wrap" class="fixedToolbar">
 
    <div class="title">{{ title }}</div> 
    <!--
    <div class="userCart">
        <mat-icon matBadge="{{cart.length}}" matBadgeColor="primary">shopping_cart</mat-icon>
          <span class="cdk-visually-hidden">Items in cart
          </span>
        <button style="margin-left: 25px;" mat-button color="warn" (click)="clearCart()">Clear cart</button>
  
    </div>  -->
    <br />
    
    <mat-accordion>
        <mat-expansion-panel class="searchPanel" [(expanded)]="searchPanelOpenState">
          <mat-expansion-panel-header>
            <mat-panel-title>
              Search Selection
            </mat-panel-title>
          </mat-expansion-panel-header>
         
          
              <!--<div>New Kensington: 229    Butler: 202    Pittsburgh: 203</div> -->
              <mat-form-field style="margin-left: 30px;" >
                  <select (change)="storeChanged();" matNativeControl placeholder="store" [(ngModel)]="selectedStore" name="store">
                    <option *ngFor="let store of stores" [value]="store.id">
                      {{store.name}}
                    </option>
                  </select>
              </mat-form-field>
  
              <mat-form-field style="margin-left: 30px;" >
                  <select (change)="filterChanged();" matNativeControl placeholder="filter" [(ngModel)]="selectedFilter" name="filter">
                    <option *ngFor="let filter of filters" [value]="filter">
                      {{filter}}
                    </option>
                  </select>
              </mat-form-field>
  
              <mat-form-field style="margin-left: 30px;" >
                  <select (change)="categoryChanged();" matNativeControl placeholder="category" [(ngModel)]="selectedCategory" name="category">
                    <option *ngFor="let cat of categories" [value]="cat">
                      {{cat}}
                    </option>
                  </select>
              </mat-form-field>
  
              <mat-form-field style="margin-left: 30px;"  class="example-form-field">
                <input matInput type="text" placeholder="Search Text" [(ngModel)]="searchText">
              </mat-form-field>
  
              <button (click)="search(); searchPanelOpenState=searchPanelOpenState?false:true;" mat-button color="primary">Search</button>
  
        
  
        </mat-expansion-panel>
      </mat-accordion>
       
  
  <!--
    <mat-form-field style="margin-left: 30px;"  class="example-form-field">
        <input matInput type="text" placeholder="hours" [(ngModel)]="newWithinHours">
      </mat-form-field>-->
        
  </div>
  
  
  <div *ngIf="isLoading" class="loading">Loading&#8230;</div>
  
  <div class="content">
    <mat-accordion style="margin-top: 5px; margin-bottom: 5px;" *ngIf="newItems && newItems.length > 0">
        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title>
                New Items ({{ newItems.length }})
            </mat-panel-title>
            <mat-panel-description>
              last {{newWithinHours}} hours
          </mat-panel-description>
          </mat-expansion-panel-header>
        <div fxLayout="row wrap">
          <div *ngFor="let item of newItems">
             <!-- <mat-card>
                  <div style="font-size: 20px;">{{ item.name }}&nbsp;({{item.category}})</div>
                  <div>{{ item.brand }}</div>
              
                price: ${{ item.price_point.prices[0].price}}
                <br/>
              </mat-card> -->



              <mat-card (click)="displayDetails(item)" 
              style="word-break: normal; cursor:pointer; margin: 2px;" 
              [ngStyle]="getCardStyle()"
              >  
                <mat-card-title 
                [ngStyle]="
                {
                  'font-size': '15px',
                  'text-align': 'center',
                  'height': '35px'
                }">
                    {{ getDisplayName(item) }}
                </mat-card-title> 

                
                <div *ngIf="item.product && item.category==='vapes'">
                    <img mat-card-sm-image style="width: 100%; height: 100%;"
                    [src]="item.product.image_url_main" 
                    default="{{item.product.image_url_alt}}" 
                    />
                </div>
                <div *ngIf="item.product && item.category==='concentrates' && item.sub_category==='syringe'">
                    <img mat-card-sm-image style="width: 100%; height: 100%;"
                    [src]="item.product.image_url_main" 
                    default="{{item.product.image_url_alt}}" 
                    />
                </div>
                <div *ngIf="item.category==='flower'">
                    <div *ngIf="item.product && item.product_strain">
                        <img mat-card-sm-image style="width: 100%; height: 100%;"
                        [src]="item.product_strain.image_url_main" 
                        default="{{item.product.image_url_main}}" 
                        />
                    </div>
                    <div *ngIf="!item.product && item.product_strain">
                        <img mat-card-sm-image style="width: 100%; height: 100%;"
                        [src]="item.product_strain.image_url_main" 
                        default="{{item.product_strain.image_url_alt}}" 
                        />
                    </div>
                    <div *ngIf="item.product && !item.product_strain">
                        <img mat-card-sm-image style="width: 100%; height: 100%;"
                        [src]="item.product.image_url_main" 
                        default="{{item.product.image_url_alt}}" 
                        />
                    </div>
                </div>
                <!--<div *ngIf="item.product && item.product_strain">
                    <img mat-card-sm-image style="width: 100%; height: 100%;"
                    [src]="item.product_strain.image_url_main" 
                    default="{{item.product.image_url_main}}" 
                    />
                </div>
                <div *ngIf="!item.product && item.product_strain">
                    <img mat-card-sm-image style="width: 100%; height: 100%;"
                    [src]="item.product_strain.image_url_main" 
                    default="{{item.product_strain.image_url_alt}}" 
                    />
                </div>
                <div *ngIf="item.product && !item.product_strain">
                    <img mat-card-sm-image style="width: 100%; height: 100%;"
                    [src]="item.product.image_url_main" 
                    default="{{item.product.image_url_alt}}" 
                    />
                </div> -->
                <div>{{ getBrand(item) }}
                  <div class="muted">{{ getType(item) }}</div> 
                  <div class="muted" fxLayout="row wrap" 
                  [ngStyle]="getPotencyListStyle()">
                    <div>thc: {{ item.bt_potency_thc || 0 | number:'1.1-1' }}% &nbsp;</div>
                    <div>thca: {{ item.bt_potency_thca || 0 | number:'1.1-1'}}%  </div>
                    <div *ngIf="item.bt_potency_cbd > 0">cbd: {{ item.bt_potency_cbd || 0 | number:'1.1-1' }}%</div>
                  </div>
               
                  <mat-chip-list *ngIf="item.prices && item.prices.length > 0" fxLayoutAlign="center" style="position:absolute;bottom: 0; margin-bottom: 5px;">
                      <mat-chip *ngFor="let price of item.prices" 
                      style="font-size: 10px; background-color: #499b4a;" 
                      >${{price.price}}<div *ngIf="item.category==='flower'">&nbsp;/&nbsp;{{price.weight}}</div></mat-chip>
                      <br />
                   
                </mat-chip-list>
                <mat-chip-list *ngIf="item.price_point && item.price_point.length > 0" fxLayoutAlign="center" style="position:absolute;bottom: 0; margin-bottom: 5px;">
                    <mat-chip *ngFor="let price of item.price_point.prices" 
                    style="font-size: 10px; background-color: #499b4a;" 
                    >${{price.price}}<div *ngIf="item.category==='flower'">&nbsp;/&nbsp;{{price.weight}}</div></mat-chip>
                    <br />
                 
              </mat-chip-list>
                
              <!--  <div *ngIf="!item.prices">
                    price: ${{ item.price_point.prices[0].price}}
                </div>-->
      
                </div>
              </mat-card>

            </div>
          </div>
        </mat-expansion-panel>
      </mat-accordion>
   
    <mat-accordion style="margin-top: 5px; margin-bottom: 5px;" *ngIf="(flowers && flowers.length > 0) && (selectedCategory === 'all' || selectedCategory === 'flower')">
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            Flower ({{filterMetadata.count}})
          </mat-panel-title>
        </mat-expansion-panel-header>
     
      <div fxLayout="row wrap">
        <div *ngFor="let item of flowers | sortBy: sortBy:'desc' | menuFilter:selectedFilter:filterMetadata"       
        >
          <mat-card (click)="displayDetails(item)" 
          style="word-break: normal; cursor:pointer; margin: 2px;" 
          [ngStyle]="getCardStyle()"
          >  
            <mat-card-title 
            [ngStyle]="
            {
              'font-size': '15px',
              'text-align': 'center',
              'height': '35px'
            }">
                {{ getDisplayName(item) }}
            </mat-card-title>
          
            
            <div *ngIf="item.product && item.product_strain">
                <img mat-card-sm-image style="width: 100%; height: 100%;"
                [src]="item.product_strain.image_url_main" 
                default="{{item.product.image_url_main}}" 
                />
            </div>
            <div *ngIf="!item.product && item.product_strain">
                <img mat-card-sm-image style="width: 100%; height: 100%;"
                [src]="item.product_strain.image_url_main" 
                default="{{item.product_strain.image_url_alt}}" 
                />
            </div>
            <div *ngIf="item.product && !item.product_strain">
                <img mat-card-sm-image style="width: 100%; height: 100%;"
                [src]="item.product.image_url_main" 
                default="{{item.product.image_url_alt}}" 
                />
            </div>
            <div>{{ getBrand(item) }}
              <div class="muted">{{ getType(item) }}</div> 
              <div class="muted" fxLayout="row wrap" 
              [ngStyle]="getPotencyListStyle()">
                <div>thc: {{ item.bt_potency_thc || 0 | number:'1.1-1' }}% &nbsp;</div>
                <div>thca: {{ item.bt_potency_thca || 0 | number:'1.1-1'}}%  </div>
                <div *ngIf="item.bt_potency_cbd > 0">cbd: {{ item.bt_potency_cbd || 0 | number:'1.1-1' }}%</div>
              </div>
           
              <mat-chip-list fxLayoutAlign="center" style="position:absolute;bottom: 0; margin-bottom: 5px;">
                  <mat-chip *ngFor="let price of item.prices" 
                  style="font-size: 10px; background-color: #499b4a;" 
                  >${{price.price}}&nbsp;/&nbsp;{{price.weight}}</mat-chip>
                  <br />
               
            </mat-chip-list>
            
          <!--  <div *ngIf="!item.prices">
                price: ${{ item.price_point.prices[0].price}}
            </div>-->
  
            </div>
          </mat-card>
        </div>
    </div>
  
      </mat-expansion-panel>
    </mat-accordion>
    <mat-accordion  style="margin-top: 5px; margin-bottom: 5px;" *ngIf="vapes && vapes.length > 0  && (selectedCategory === 'all' || selectedCategory === 'vapes')">
        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title>
              Vapes ({{filterMetadata.count}})
            </mat-panel-title>
          </mat-expansion-panel-header>
          <div *ngFor="let item of vapes | sortBy: 'bt_potency_thc':'desc' |  menuFilter:selectedFilter:filterMetadata">
              <mat-card>
                  <div style="font-size: 20px;">{{ item.brand || item.product.name }} - {{ item.name }}</div>
                  <div *ngIf="item.product_strain && item.product_strain.description" style="font-size: 16px;">{{ item.product_strain.description }}</div>
              
                  <div>thc: {{ item.bt_potency_thc || 0 }}%</div>
                  <div>thca: {{ item.bt_potency_thca || 0 }}%  </div>
                  <div>price: ${{ item.price_point.prices[0].price}}</div>
                  <div>quantity remaining: {{ item.bt_remaining_quantity }}</div>
              </mat-card>
            </div>
        </mat-expansion-panel>
      </mat-accordion>
  
  
      <mat-accordion style="margin-top: 5px; margin-bottom: 5px;" *ngIf="concentrates && concentrates.length > 0  && (selectedCategory === 'all' || selectedCategory === 'concentrates')">
        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title>
              Concentrates ({{filterMetadata.count}})
            </mat-panel-title>
          </mat-expansion-panel-header>
  
          <div *ngFor="let item of concentrates | sortBy: sortBy:'desc'| menuFilter:selectedFilter:filterMetadata">
              <mat-card>
                  <div style="font-size: 20px;">{{ item.brand || item.product.name }} - {{ item.name }}</div>
                  <div *ngIf="item.product_strain && item.product_strain.description" style="font-size: 16px;">{{ item.product_strain.description }}</div>
              
                  <div>thc: {{ item.bt_potency_thc || 0 }}%</div>
                  <div>thca: {{ item.bt_potency_thca || 0 }}%  </div>
                  <div>price: ${{ item.price_point.prices[0].price}}</div>
                  <div>quantity remaining: {{ item.bt_remaining_quantity }}</div>
                  
              </mat-card>
            </div>
        </mat-expansion-panel>
      </mat-accordion>
  
      <mat-accordion style="margin-top: 5px; margin-bottom: 5px;" *ngIf="tinctures && tinctures.length > 0  && (selectedCategory === 'all' || selectedCategory === 'tinctures')">
          <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title>
              Tinctures ({{filterMetadata.count}})
            </mat-panel-title>
          </mat-expansion-panel-header>
          <div *ngFor="let item of tinctures | sortBy: 'brand':'asc'| menuFilter:selectedFilter:filterMetadata">
              <mat-card>
                  <div style="font-size: 20px;">{{ item.brand }} - {{ item.name }}</div>
                  <div>thc: {{ item.bt_potency_thc || 0 }}%</div>
                  <div>thca: {{ item.bt_potency_thca || 0 }}%  </div>
                  <div>price: ${{ item.price_point.prices[0].price}}</div>
                  <div>quantity remaining: {{ item.bt_remaining_quantity }}</div>
              </mat-card>
            </div>
  
        </mat-expansion-panel>
      </mat-accordion>
  
  
    <mat-accordion style="margin-top: 5px; margin-bottom: 5px;" *ngIf="capsules && capsules.length > 0  && (selectedCategory === 'all' || selectedCategory === 'capsules')">
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            Capsules ({{filterMetadata.count}})
          </mat-panel-title>
        </mat-expansion-panel-header>
  
        <div *ngFor="let item of capsules | sortBy: 'brand':'asc'| menuFilter:selectedFilter:filterMetadata">
            <mat-card>
                <div style="font-size: 20px;">{{ item.brand || item.product.name }} - {{ item.name }}</div>
                <div>thc: {{ item.bt_potency_thc || 0 }}%</div>
                <div>thca: {{ item.bt_potency_thca || 0 }}%  </div>
                <div>price: ${{ item.price_point.prices[0].price}}</div>
                <div>quantity remaining: {{ item.bt_remaining_quantity }}</div>
            </mat-card>
          </div>
      </mat-expansion-panel>
      </mat-accordion>
  
    <mat-accordion style="margin-top: 5px; margin-bottom: 5px;" *ngIf="topicals && topicals.length > 0  && (selectedCategory === 'all' || selectedCategory === 'topicals')">
        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title>
              Topicals ({{filterMetadata.count}})
            </mat-panel-title>
          </mat-expansion-panel-header>
          <div *ngFor="let item of topicals | sortBy: 'brand':'asc'| menuFilter:selectedFilter:filterMetadata">
              <mat-card>
                  <div style="font-size: 20px;">{{ item.brand || item.product.name }} - {{ item.name }}</div>
                  <div>thc: {{ item.bt_potency_thc || 0 }}%</div>
                  <div>thca: {{ item.bt_potency_thca || 0 }}%  </div>
                  <div>price: ${{ item.price_point.prices[0].price}}</div>
                  <div>quantity remaining: {{ item.bt_remaining_quantity }}</div>
              </mat-card>
            </div>
        </mat-expansion-panel>
      </mat-accordion>
  
    <mat-accordion style="margin-top: 5px; margin-bottom: 5px;" *ngIf="accessories && accessories.length > 0  && (selectedCategory === 'all' || selectedCategory === 'accessories')">
        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title>
                Accessories ({{filterMetadata.count}})
            </mat-panel-title>
          </mat-expansion-panel-header>
          <div *ngFor="let item of accessories | sortBy: 'brand':'asc'| menuFilter:selectedFilter:filterMetadata">
              <mat-card>
                  <div style="font-size: 20px;">{{ item.name }}</div>
              
                price: ${{ item.price_point.prices[0].price}}
                <br/>
              </mat-card>
            </div>
  
        </mat-expansion-panel>
      </mat-accordion>
  
    <div *ngIf="fullMenu.total_rows === undefined && searchComplete">
      <mat-card>No Items Found.</mat-card>
    </div>
  </div>
  <router-outlet></router-outlet>
  